#!/bin/sh

# assumes you already have a modern ruby installed

# make a directory for executables if it doesn't already exist
mkdir -p ~/bin
# add it to the path for this session
export PATH="$HOME/bin:$PATH"

# awesome extension for the git interface https://github.com/github/hub
echo "Installing hub"
gem install hub
hub hub standalone > ~/bin/hub
chmod +x ~/bin/hub

echo "Installing git tab completion" # https://github.com/git/git/blob/master/contrib/completion/git-completion.bash
curl https://raw.githubusercontent.com/git/git/master/contrib/completion/git-completion.bash > ~/.git-completion

echo "Installing selecta, the vim fuzzy file opener thing" # https://github.com/garybernhardt/selecta
curl https://raw.github.com/garybernhardt/selecta/master/selecta > ~/bin/selecta
chmod +x ~/bin/selecta

echo "Installing pathogen, the vim plugin loader" # https://github.com/tpope/vim-pathogen
mkdir -p ~/.vim/autoload ~/.vim/bundle ~/.vim/backup ~/.vim/tmp

curl https://raw.githubusercontent.com/tpope/vim-pathogen/master/autoload/pathogen.vim > ~/.vim/autoload/pathogen.vim

echo "Installing several vim plugins"
echo "If it's already installed, you may see a 'fatal' error message -- you'll live"
for plugin in $(cat vim_plugins.txt); do
  cd ~/.vim/bundle
  hub clone $plugin
  cd -
done

echo "Moving dotfiles into place"
for filename in $(ls configs -A); do
  echo $filename
  if [ -f ~/$filename ];
  then
    echo "~/$filename already exists -- not overwriting"
  else
    echo "Creating ~/$filename"
    cp configs/$filename ~
  fi
done

echo 'Final instructions: add `source ~/.bash_additions` to your ~/.bash_profile`'
echo 'And add `source ~/.bash_profile` to your ~/.bashrc'
echo "And make sure you don't have a ~/.profile or ~/.zshrc"
