#!/usr/bin/env fish

# Usage:
# $ paywall "https://cooking.nytimes.com/recipes/1893-everyday-pancakes"

if test (count $argv) -ne 1
    echo "Provide exactly one argument" >&2
    exit 1
end

# Using GNU mktemp (brew install coreutils on macOS) because it can create tempfiles
# with a particular extension
set --local f (gmktemp -t "document.XXXXXXXXXX.html")

if curl --silent --show-error --location "$argv[1]" --output "$f"
    open "$f"
else
    exit 1
end
